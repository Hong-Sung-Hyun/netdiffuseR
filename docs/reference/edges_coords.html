<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute ego/alter edge coordinates considering alter's size and aspect ratio — edges_coords • netdiffuseR</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Compute ego/alter edge coordinates considering alter's size and aspect ratio — edges_coords" />

<meta property="og:description" content="Given a graph, vertices' positions and sizes, calculates the absolute positions
of the endpoints of the edges considering the plot's aspect ratio." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">netdiffuseR</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.19.999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/analyzing-medical-innovation-data.html">netdiffuseR showcase: Medical Innovations</a>
    </li>
    <li>
      <a href="../articles/introduction-to-netdiffuser.html">Simulating diffusion networks: Using the `rdiffnet` function</a>
    </li>
    <li>
      <a href="../articles/not-lost-in-translation-importing-and-exporting-graphs.html">Not-Lost in translation: Getting diffusion data into netdiffuseR</a>
    </li>
    <li>
      <a href="../articles/time_discount_suscep_infect.html">Time Discounted Infection and Susceptibility</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/USCCANA/netdiffuseR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute ego/alter edge coordinates considering alter's size and aspect ratio</h1>
    <small class="dont-index">Source: <a href='https://github.com/USCCANA/netdiffuseR/blob/master/R/RcppExports.R'><code>R/RcppExports.R</code></a></small>
    <div class="hidden name"><code>edges_coords.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Given a graph, vertices' positions and sizes, calculates the absolute positions
of the endpoints of the edges considering the plot's aspect ratio.</p>
    
    </div>

    <pre class="usage"><span class='fu'>edges_coords</span>(<span class='no'>graph</span>, <span class='no'>toa</span>, <span class='no'>x</span>, <span class='no'>y</span>, <span class='no'>vertex_cex</span>, <span class='kw'>undirected</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>no_contemporary</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>dev</span> <span class='kw'>=</span> <span class='fu'>as.numeric</span>(<span class='fu'>c</span>()), <span class='kw'>ran</span> <span class='kw'>=</span> <span class='fu'>as.numeric</span>(<span class='fu'>c</span>()),
  <span class='kw'>curved</span> <span class='kw'>=</span> <span class='fu'>as.logical</span>(<span class='fu'>c</span>()))</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>graph</th>
      <td><p>A square matrix of size \(n\). Adjacency matrix.</p></td>
    </tr>
    <tr>
      <th>toa</th>
      <td><p>Integer vector of size \(n\). Times of adoption.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Numeric vector of size \(n\). x-coordinta of vertices.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>Numeric vector of size \(n\). y-coordinta of vertices.</p></td>
    </tr>
    <tr>
      <th>vertex_cex</th>
      <td><p>Numeric vector of size \(n\). Vertices' sizes in terms
of the x-axis (see <code>symbols</code>).</p></td>
    </tr>
    <tr>
      <th>undirected</th>
      <td><p>Logical scalar. Whether the graph is undirected or not.</p></td>
    </tr>
    <tr>
      <th>no_contemporary</th>
      <td><p>Logical scalar. Whether to return (compute) edges'
coordiantes for vertices with the same time of adoption (see details).</p></td>
    </tr>
    <tr>
      <th>dev</th>
      <td><p>Numeric vector of size 2. Height and width of the device (see details).</p></td>
    </tr>
    <tr>
      <th>ran</th>
      <td><p>Numeric vector of size 2. Range of the x and y axis (see details).</p></td>
    </tr>
    <tr>
      <th>curved</th>
      <td><p>Logical vector.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A numeric matrix of size \(m\times 5\) with the following
columns:</p>
<dt>x0, y0</dt><dd><p>Edge origin</p></dd>
<dt>x1, y1</dt><dd><p>Edge target</p></dd>
<dt>alpha</dt><dd><p>Relative angle between <code>(x0,y0)</code> and <code>(x1,y1)</code> in terms
of radians</p></dd>
With m as the number of resulting edges.

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In order to make the plot's visualization more appealing, this function provides
a straight forward way of computing the tips of the edges considering the
aspect ratio of the axes range. In particular, the following corrections are
made at the moment of calculating the egdes coords:</p>
<ul>
<li><p>Instead of using the actual distance between ego and alter, a relative
one is calculated as follows
$$d'=\left[(x_0-x_1)^2 + (y_0' - y_1')^2\right]^\frac{1}{2}$$
where \(%
y_i'=y_i\times\frac{\max x - \min x}{\max y - \min y} \)</p></li>
<li><p>Then, for the relative elevation angle, <code>alpha</code>, the relative distance \(d'\)
is used, \(\alpha'=\arccos\left( (x_0 - x_1)/d' \right)\)</p></li>
<li><p>Finally, the edge's endpoint's (alter) coordinates are computed as follows: <!-- % -->
$$%
  x_1' = x_1 + \cos(\alpha')\times v_1$$
$$%
  y_1' = y_1 -+ \sin(\alpha')\times v_1 \times\frac{\max y - \min y}{\max x - \min x} $$
Where \(v_1\) is alter's size in terms of the x-axis, and the sign of
the second term in \(y_1'\) is negative iff \(y_0 &lt; y_1\).</p></li>
</ul>
    <p>The same process (with sign inverted) is applied to the edge starting piont.
The resulting values, \(x_1',y_1'\) can be used with the function
<code>arrows</code>. This is the workhorse function used in <code><a href='plot_threshold.html'>plot_threshold</a></code>.</p>
<p>The <code>dev</code> argument provides a reference to rescale the plot accordingly
to the device, and former, considering the size of the margins as well (this
can be easily fetched via <code>par("pin")</code>, plot area in inches).</p>
<p>On the other hand, <code>ran</code> provides a reference for the adjustment
according to the range of the data, this is <code>range(x)[2] - range(x)[1]</code>
and <code>range(y)[2] - range(y)[1]</code> respectively.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># --------------------------------------------------------------------------</span>
<span class='fu'>data</span>(<span class='no'>medInnovationsDiffNet</span>)
<span class='fu'>library</span>(<span class='no'>sna</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: statnet.common</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘statnet.common’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    order</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: network</span></div><div class='output co'>#&gt; <span class='message'>network: Classes for Relational Data</span>
#&gt; <span class='message'>Version 1.13.0.1 created on 2015-08-31.</span>
#&gt; <span class='message'>copyright (c) 2005, Carter T. Butts, University of California-Irvine</span>
#&gt; <span class='message'>                    Mark S. Handcock, University of California -- Los Angeles</span>
#&gt; <span class='message'>                    David R. Hunter, Penn State University</span>
#&gt; <span class='message'>                    Martina Morris, University of Washington</span>
#&gt; <span class='message'>                    Skye Bender-deMoll, University of Washington</span>
#&gt; <span class='message'> For citation information, type citation("network").</span>
#&gt; <span class='message'> Type help("network-package") to get started.</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘network’</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:igraph’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    add.edges, add.vertices, %c%, delete.edges, delete.vertices,</span>
#&gt; <span class='message'>    get.edge.attribute, get.edges, get.vertex.attribute, is.bipartite,</span>
#&gt; <span class='message'>    is.directed, list.edge.attributes, list.vertex.attributes, %s%,</span>
#&gt; <span class='message'>    set.edge.attribute, set.vertex.attribute</span></div><div class='output co'>#&gt; <span class='message'>sna: Tools for Social Network Analysis</span>
#&gt; <span class='message'>Version 2.4 created on 2016-07-23.</span>
#&gt; <span class='message'>copyright (c) 2005, Carter T. Butts, University of California-Irvine</span>
#&gt; <span class='message'> For citation information, type citation("sna").</span>
#&gt; <span class='message'> Type help(package="sna") to get started.</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘sna’</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:igraph’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    betweenness, bonpow, closeness, components, degree, dyad.census,</span>
#&gt; <span class='message'>    evcent, hierarchy, is.connected, neighborhood, triad.census</span></div><div class='input'>
<span class='co'># Computing coordinates</span>
<span class='fu'>set.seed</span>(<span class='fl'>79</span>)
<span class='no'>coords</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sna</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/sna/topics/gplot'>gplot</a></span>(<span class='fu'>as.matrix</span>(<span class='no'>medInnovationsDiffNet</span>$<span class='no'>graph</span><span class='kw'>[[</span><span class='fl'>1</span>]]))</div><div class='img'><img src='edges_coords-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Getting edge coordinates</span>
<span class='no'>vcex</span> <span class='kw'>&lt;-</span> <span class='fu'>rep</span>(<span class='fl'>1.5</span>, <span class='fu'><a href='nvertices.html'>nnodes</a></span>(<span class='no'>medInnovationsDiffNet</span>))
<span class='no'>ecoords</span> <span class='kw'>&lt;-</span> <span class='fu'>edges_coords</span>(
  <span class='no'>medInnovationsDiffNet</span>$<span class='no'>graph</span><span class='kw'>[[</span><span class='fl'>1</span>]],
  <span class='fu'><a href='diffnet-class.html'>diffnet.toa</a></span>(<span class='no'>medInnovationsDiffNet</span>),
  <span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>coords</span>[,<span class='fl'>1</span>], <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>coords</span>[,<span class='fl'>2</span>],
  <span class='kw'>vertex_cex</span> <span class='kw'>=</span> <span class='no'>vcex</span>,
  <span class='kw'>dev</span> <span class='kw'>=</span> <span class='fu'>par</span>(<span class='st'>"pin"</span>)
  )

<span class='no'>ecoords</span> <span class='kw'>&lt;-</span> <span class='fu'>as.data.frame</span>(<span class='no'>ecoords</span>)

<span class='co'># Plotting</span>
<span class='fu'>symbols</span>(<span class='no'>coords</span>[,<span class='fl'>1</span>], <span class='no'>coords</span>[,<span class='fl'>2</span>], <span class='kw'>circles</span><span class='kw'>=</span><span class='no'>vcex</span>,
  <span class='kw'>inches</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>xaxs</span><span class='kw'>=</span><span class='st'>"i"</span>, <span class='kw'>yaxs</span><span class='kw'>=</span><span class='st'>"i"</span>)</div><div class='input'>
<span class='fu'>with</span>(<span class='no'>ecoords</span>, <span class='fu'>arrows</span>(<span class='no'>x0</span>,<span class='no'>y0</span>,<span class='no'>x1</span>,<span class='no'>y1</span>, <span class='kw'>length</span><span class='kw'>=</span><span class='fl'>.1</span>))</div><div class='img'><img src='edges_coords-2.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by George Vega Yon, Thomas Valente.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

