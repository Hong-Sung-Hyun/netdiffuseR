<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Netdiffuser by USCCANA</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Netdiffuser</h1>
        <h2>netdiffuseR: Network Analysis for Diffusion of Innovations</h2>
        <a href="https://github.com/USCCANA/netdiffuseR" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a id="netdiffuser-network-analysis-for-diffusion-of-innovations" class="anchor" href="#netdiffuser-network-analysis-for-diffusion-of-innovations" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>netdiffuseR: Network Analysis for Diffusion of Innovations</h1>

<p><a href="https://travis-ci.org/USCCANA/netdiffuseR"><img src="https://travis-ci.org/USCCANA/netdiffuseR.svg?branch=master" alt="Build Status"></a> <a href="https://ci.appveyor.com/project/gvegayon/netdiffuser"><img src="https://ci.appveyor.com/api/projects/status/6u48wgl1lqak2jum?svg=true" alt="Build status"></a> <a href="https://codecov.io/github/USCCANA/netdiffuseR?branch=master"><img src="https://codecov.io/github/USCCANA/netdiffuseR/coverage.svg?branch=master" alt="codecov.io"></a> <a href="http://cran.rstudio.com/web/packages/netdiffuseR/index.html"><img src="http://cranlogs.r-pkg.org/badges/netdiffuseR" alt=""></a> <a href="http://cran.r-project.org/package=netdiffuseR"><img src="http://www.r-pkg.org/badges/version/netdiffuseR" alt="CRAN\_Status\_Badge"></a> <a href="http://cran.rstudio.com/web/packages/netdiffuseR/index.html"><img src="http://cranlogs.r-pkg.org/badges/grand-total/netdiffuseR" alt=""></a></p>

<p>This package contains functions useful for analyzing network data for diffusion of innovations applications.</p>

<p>The package was developed as part of the paper Thomas W. Valente, Stephanie R. Dyal, Kar-Hai Chu, Heather Wipfli, Kayo Fujimoto, <em>Diffusion of innovations theory applied to global tobacco control treaty ratification</em>, Social Science &amp; Medicine, Volume 145, November 2015, Pages 89-97, ISSN 0277-9536 (available <a href="http://www.sciencedirect.com/science/article/pii/S027795361530143X">here</a>)</p>

<p>From the description:</p>

<blockquote>
<p>Empirical statistical analysis, visualization and simulation of network models of the diffusion of innovations. The package implements algorithms for calculating network diffusion statistics such as transmission rate, hazard rates, exposure models, network threshold levels, infectiousness (contagion), and susceptibility. The package is inspired by work published in Valente, et al., (2015) DOI:10.1016/j.socscimed.2015.10.001; Valente (1995) ISBN:9781881303213, Myers (2000) DOI:10.1086/303110, Iyengar and others (2011) DOI:10.1287/mksc.1100.0566, Burt (1987) DOI:10.1086/228667; among others.</p>
</blockquote>

<p><strong>Acknowledgements</strong>: netdiffuseR was created with the support of grant R01 CA157577 from the National Cancer Institute/National Institutes of Health.</p>

<h2>
<a id="news" class="anchor" href="#news" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>News</h2>

<p>Changelog can be view <a href="NEWS.md">here</a>.</p>

<ul>
<li>  [2016-06-02] A video of the <strong>netdiffuseR</strong> workshop at SUNBELT 2016 is now online on <a href="https://www.youtube.com/playlist?list=PLT-GgRN1lFI4coHDqkRJm3flDw9e1gg2P">youtube</a>, and the workshop materials can be found <a href="https://github.com/USCCANA/netdiffuseR/tree/master/doc/conferences/20160400_sunbelt2016/">here</a>
</li>
<li>  [2016-04-11] <strong>netdiffuseR</strong> will be on <a href="http://user2016.org">useR! 2016</a> on as a presentation and on <a href="http://www.kellogg.northwestern.edu/news-events/conference/ic2s2/2016.aspx">IC2S2 2016</a> in the posters session.</li>
<li>  [2016-03-16] Next CRAN release scheduled for April 11th 2016 (after the workshop).</li>
<li>  [2016-02-18] <strong>netdiffuseR</strong> vers 1.16.2 is now on CRAN!</li>
<li>  [2016-02-18] We will be offering a workshop at the 2016 SUNBELT Conference (checkout the full list of workshops <a href="http://insna.org/sunbelt2016/program/">here</a>).</li>
</ul>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<h3>
<a id="cran-version" class="anchor" href="#cran-version" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>CRAN version</h3>

<p>To get the CRAN (stable) version of the package, simple type</p>

<div class="highlight highlight-source-r"><pre>install.packages(<span class="pl-s"><span class="pl-pds">"</span>netdiffuseR<span class="pl-pds">"</span></span>)</pre></div>

<h3>
<a id="bleeding-edge-version" class="anchor" href="#bleeding-edge-version" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Bleeding edge version</h3>

<p>If you want the latest (unstable) version of <strong>netdiffuseR</strong>, using the <code>devtools</code> package, you can install <code>netdiffuseR</code> dev version as follows</p>

<div class="highlight highlight-source-r"><pre><span class="pl-e">devtools</span><span class="pl-k">::</span>install_github(<span class="pl-s"><span class="pl-pds">'</span>USCCANA/netdiffuseR<span class="pl-pds">'</span></span>, <span class="pl-v">build_vignettes</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>)</pre></div>

<p>You can skip building vignettes by setting <code>build_vignettes = FALSE</code> (so it is not required).</p>

<p>For the case of OSX users, there seems to be a problem when installing packages depending on <code>Rcpp</code>. This issue, developed <a href="https://github.com/USCCANA/netdiffuseR/issues/3">here</a>, can be solved by open the terminal and typing the following</p>

<div class="highlight highlight-source-shell"><pre>curl -O http://r.research.att.com/libs/gfortran-4.8.2-darwin13.tar.bz2
sudo tar fvxz gfortran-4.8.2-darwin13.tar.bz2 -C /</pre></div>

<p>before installing the package through <code>devtools</code>.</p>

<h3>
<a id="binary-versions" class="anchor" href="#binary-versions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Binary versions</h3>

<p>For the case of windows and mac users, they can find binary versions of the package <a href="https://github.com/USCCANA/netdiffuseR/releases">here</a>, netdiffuseR_1...zip, and netdiffuseR_1...tgz respectively. They can install this directly as follows (using the 1.16.3.29 version):</p>

<ol>
<li>
<p>Install dependencies from CRAN</p>

<div class="highlight highlight-source-r"><pre><span class="pl-k">&gt;</span> install.packages(c(<span class="pl-s"><span class="pl-pds">"</span>igraph<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Matrix<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>SparseM<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>RcppArmadillo<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>sna<span class="pl-pds">"</span></span>), <span class="pl-v">dependencies</span><span class="pl-k">=</span><span class="pl-c1">TRUE</span>)</pre></div>
</li>
<li>
<p>Download the binary version and install it as follows:</p>

<div class="highlight highlight-source-r"><pre><span class="pl-k">&gt;</span> install.packages(<span class="pl-s"><span class="pl-pds">"</span>netdiffuseR_1.16.3.29.zip<span class="pl-pds">"</span></span>, <span class="pl-v">repos</span><span class="pl-k">=</span><span class="pl-c1">NULL</span>)</pre></div>

<p>For windows users, and for Mac users:</p>

<div class="highlight highlight-source-r"><pre><span class="pl-k">&gt;</span> install.packages(<span class="pl-s"><span class="pl-pds">"</span>netdiffuseR_1.16.3.29.tgz<span class="pl-pds">"</span></span>, <span class="pl-v">repos</span><span class="pl-k">=</span><span class="pl-c1">NULL</span>)</pre></div>
</li>
</ol>

<h2>
<a id="examples" class="anchor" href="#examples" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Examples</h2>

<p>This example has been taken from the package's vignettes:</p>

<div class="highlight highlight-source-r"><pre>library(<span class="pl-smi">netdiffuseR</span>)</pre></div>

<pre><code>## 
## Attaching package: 'netdiffuseR'

## The following object is masked from 'package:base':
## 
##     %*%
</code></pre>

<h3>
<a id="infectiousness-and-susceptibility" class="anchor" href="#infectiousness-and-susceptibility" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Infectiousness and Susceptibility</h3>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Generating a random graph</span>
set.seed(<span class="pl-c1">1234</span>)
<span class="pl-smi">n</span> <span class="pl-k">&lt;-</span> <span class="pl-c1">100</span>
<span class="pl-smi">nper</span> <span class="pl-k">&lt;-</span> <span class="pl-c1">20</span>
<span class="pl-smi">graph</span> <span class="pl-k">&lt;-</span> rgraph_er(<span class="pl-smi">n</span>, <span class="pl-smi">nper</span>, .<span class="pl-c1">5</span>)
<span class="pl-smi">toa</span> <span class="pl-k">&lt;-</span> sample(c(<span class="pl-c1">1</span><span class="pl-k">:</span>(<span class="pl-c1">1</span><span class="pl-k">+</span><span class="pl-smi">nper</span><span class="pl-k">-</span><span class="pl-c1">1</span>), <span class="pl-c1">NA</span>), <span class="pl-smi">n</span>, <span class="pl-c1">TRUE</span>)
head(<span class="pl-smi">toa</span>)</pre></div>

<pre><code>## [1] 20  7  9  1 17 14
</code></pre>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Creating a diffnet object</span>
<span class="pl-smi">diffnet</span> <span class="pl-k">&lt;-</span> as_diffnet(<span class="pl-smi">graph</span>, <span class="pl-smi">toa</span>)
<span class="pl-smi">diffnet</span></pre></div>

<pre><code>## Dynamic network of class -diffnet-
##  # of nodes         : 100 (1, 2, 3, 4, 5, 6, 7, 8, ...)
##  # of time periods  : 20 (1 - 20)
##  Type               : directed
##  Final prevalence   : 0.95
##  Static attributes  : -
##  Dynamic attributes : -
</code></pre>

<div class="highlight highlight-source-r"><pre>summary(<span class="pl-smi">diffnet</span>)</pre></div>

<pre><code>## Diffusion network summary statistics
## -----------------------------------------------------------------------
##  Period  Adopters Cum Adopt. Cum Adopt. % Hazard Rate Density Moran's I 
## -------- -------- ---------- ------------ ----------- ------- --------- 
##        1        3          3         0.03           -    0.50     -0.01 
##        2        8         11         0.11        0.08    0.50     -0.01 
##        3        4         15         0.15        0.04    0.51     -0.00 
##        4        1         16         0.16        0.01    0.49     -0.01 
##        5        2         18         0.18        0.02    0.50     -0.01 
##        6        5         23         0.23        0.06    0.50     -0.01 
##        7        6         29         0.29        0.08    0.51     -0.01 
##        8        1         30         0.30        0.01    0.50     -0.01 
##        9        6         36         0.36        0.09    0.50     -0.01 
##       10        5         41         0.41        0.08    0.49     -0.01 
##       11        2         43         0.43        0.03    0.50     -0.02 
##       12        6         49         0.49        0.11    0.50     -0.01 
##       13        4         53         0.53        0.08    0.50     -0.01 
##       14        7         60         0.60        0.15    0.50     -0.01 
##       15        7         67         0.67        0.17    0.50     -0.01 
##       16        3         70         0.70        0.09    0.50     -0.01 
##       17       10         80         0.80        0.33    0.49     -0.01 
##       18        4         84         0.84        0.20    0.50     -0.01 
##       19        2         86         0.86        0.12    0.50     -0.01 
##       20        9         95         0.95        0.64    0.50     -0.01 
## -----------------------------------------------------------------------
##  Left censoring  : 0.03 (3)
##  Right centoring : 0.05 (5)
##  # of nodes      : 100
</code></pre>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Visualizing distribution of suscep/infect</span>
<span class="pl-smi">out</span> <span class="pl-k">&lt;-</span> plot_infectsuscep(<span class="pl-smi">diffnet</span>, <span class="pl-v">bins</span> <span class="pl-k">=</span> <span class="pl-c1">20</span>,<span class="pl-v">K</span><span class="pl-k">=</span><span class="pl-c1">5</span>, <span class="pl-v">logscale</span> <span class="pl-k">=</span> <span class="pl-c1">FALSE</span>, <span class="pl-v">h</span><span class="pl-k">=</span>.<span class="pl-c1">01</span>)</pre></div>

<p><img src="README_files/figure-markdown_github/plot_infectsuscept-1.png" alt=""></p>

<div class="highlight highlight-source-r"><pre><span class="pl-smi">out</span> <span class="pl-k">&lt;-</span> plot_infectsuscep(<span class="pl-smi">diffnet</span>, <span class="pl-v">bins</span> <span class="pl-k">=</span> <span class="pl-c1">20</span>,<span class="pl-v">K</span><span class="pl-k">=</span><span class="pl-c1">5</span>, <span class="pl-v">logscale</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>,
                         <span class="pl-v">exclude.zeros</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>, <span class="pl-v">h</span><span class="pl-k">=</span><span class="pl-c1">1</span>,
                         <span class="pl-v">color.palette</span> <span class="pl-k">=</span> colorRampPalette(c(<span class="pl-s"><span class="pl-pds">"</span>lightblue<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>yellow<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>red<span class="pl-pds">"</span></span>)))</pre></div>

<pre><code>## Warning in plot_infectsuscep.list(graph$graph, graph$toa, t0, normalize, :
## When applying logscale some observations are missing.
</code></pre>

<p><img src="README_files/figure-markdown_github/plot_infectsuscept-2.png" alt=""></p>

<h3>
<a id="threshold" class="anchor" href="#threshold" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Threshold</h3>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Generating a random graph</span>
set.seed(<span class="pl-c1">123</span>)
<span class="pl-smi">diffnet</span> <span class="pl-k">&lt;-</span> rdiffnet(<span class="pl-c1">500</span>, <span class="pl-c1">20</span>,
                    <span class="pl-v">seed.nodes</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>random<span class="pl-pds">"</span></span>,
                    <span class="pl-v">rgraph.args</span> <span class="pl-k">=</span> <span class="pl-k">list</span>(<span class="pl-v">m</span><span class="pl-k">=</span><span class="pl-c1">3</span>),
                    <span class="pl-v">threshold.dist</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">x</span>) runif(<span class="pl-c1">1</span>, .<span class="pl-c1">3</span>, .<span class="pl-c1">7</span>))
<span class="pl-smi">diffnet</span></pre></div>

<pre><code>## Dynamic network of class -diffnet-
##  # of nodes         : 500 (1, 2, 3, 4, 5, 6, 7, 8, ...)
##  # of time periods  : 20 (1 - 20)
##  Type               : directed
##  Final prevalence   : 0.58
##  Static attributes  : real_threshold (1)
##  Dynamic attributes : -
</code></pre>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Threshold with fixed vertex size</span>
plot_threshold(<span class="pl-smi">diffnet</span>, <span class="pl-v">vertex.cex</span> <span class="pl-k">=</span> .<span class="pl-c1">4</span>)</pre></div>

<p><img src="README_files/figure-markdown_github/BoringThreshold,%20plot_threshold-1.png" alt=""></p>

<p>Using more features</p>

<div class="highlight highlight-source-r"><pre>data(<span class="pl-s"><span class="pl-pds">"</span>medInnovationsDiffNet<span class="pl-pds">"</span></span>)
<span class="pl-smi">size</span> <span class="pl-k">&lt;-</span> sqrt(<span class="pl-c1">1</span> <span class="pl-k">+</span> dgr(<span class="pl-smi">medInnovationsDiffNet</span>)[,<span class="pl-c1">1</span>])
set.seed(<span class="pl-c1">131</span>)
plot_threshold(
  <span class="pl-smi">medInnovationsDiffNet</span>,
  <span class="pl-v">vertex.label</span>   <span class="pl-k">=</span> nodes(<span class="pl-smi">medInnovationsDiffNet</span>),
  <span class="pl-v">vertex.cex</span>     <span class="pl-k">=</span> <span class="pl-smi">size</span><span class="pl-k">/</span><span class="pl-c1">10</span>, <span class="pl-v">vertex.lab.pos</span> <span class="pl-k">=</span> <span class="pl-c1">NULL</span>,
  <span class="pl-v">vertex.lab.cex</span> <span class="pl-k">=</span> <span class="pl-smi">size</span><span class="pl-k">/</span><span class="pl-c1">4</span>,
  <span class="pl-v">vertex.sides</span>   <span class="pl-k">=</span> <span class="pl-smi">medInnovationsDiffNet</span>[[<span class="pl-s"><span class="pl-pds">"</span>city<span class="pl-pds">"</span></span>]] <span class="pl-k">+</span> <span class="pl-c1">2</span>,
  <span class="pl-v">sub</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Note: Vertices' sizes and shapes given by degree and city respectively<span class="pl-pds">"</span></span>,
  <span class="pl-v">jitter.factor</span> <span class="pl-k">=</span> c(<span class="pl-c1">1</span>,<span class="pl-c1">1</span>), <span class="pl-v">jitter.amount</span> <span class="pl-k">=</span> c(.<span class="pl-c1">25</span>,.<span class="pl-c1">025</span>)
)</pre></div>

<p><img src="README_files/figure-markdown_github/NiceThreshold-1.png" alt=""></p>

<h3>
<a id="adoption-rate" class="anchor" href="#adoption-rate" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Adoption rate</h3>

<div class="highlight highlight-source-r"><pre>plot_adopters(<span class="pl-smi">diffnet</span>)</pre></div>

<p><img src="README_files/figure-markdown_github/Adopters-1.png" alt=""></p>

<h3>
<a id="hazard-rate" class="anchor" href="#hazard-rate" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Hazard rate</h3>

<div class="highlight highlight-source-r"><pre>hazard_rate(<span class="pl-smi">diffnet</span>)</pre></div>

<p><img src="README_files/figure-markdown_github/Hazard-1.png" alt=""></p>

<h3>
<a id="diffusion-process" class="anchor" href="#diffusion-process" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Diffusion process</h3>

<div class="highlight highlight-source-r"><pre>plot_diffnet(<span class="pl-smi">medInnovationsDiffNet</span>, <span class="pl-v">slices</span><span class="pl-k">=</span>c(<span class="pl-c1">1</span>,<span class="pl-c1">9</span>,<span class="pl-c1">8</span>))</pre></div>

<p><img src="README_files/figure-markdown_github/plot_diffnet-1.png" alt=""></p>

<div class="highlight highlight-source-r"><pre>diffnet.toa(<span class="pl-smi">brfarmersDiffNet</span>)[<span class="pl-smi">brfarmersDiffNet</span><span class="pl-k">$</span><span class="pl-smi">toa</span> <span class="pl-k">&gt;</span><span class="pl-k">=</span> <span class="pl-c1">1965</span>] <span class="pl-k">&lt;-</span> <span class="pl-c1">NA</span>
plot_diffnet2(<span class="pl-smi">brfarmersDiffNet</span>,
              <span class="pl-v">vertex.size</span> <span class="pl-k">=</span> dgr(<span class="pl-smi">brfarmersDiffNet</span>)[,<span class="pl-c1">3</span>])</pre></div>

<p><img src="README_files/figure-markdown_github/plot_diffnet2-1.png" alt=""></p>

<div class="highlight highlight-source-r"><pre>set.seed(<span class="pl-c1">1133</span>)
<span class="pl-smi">x</span> <span class="pl-k">&lt;-</span> rdiffnet(<span class="pl-c1">2e3</span>, <span class="pl-c1">10</span>, <span class="pl-v">seed.graph</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>small-world<span class="pl-pds">'</span></span>)
plot_diffnet2(<span class="pl-smi">x</span>, <span class="pl-v">vertex.size</span> <span class="pl-k">=</span> dgr(<span class="pl-smi">x</span>)[,nslices(<span class="pl-smi">x</span>)], <span class="pl-v">add.map</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>last<span class="pl-pds">"</span></span>,
              <span class="pl-v">diffmap.args</span> <span class="pl-k">=</span> <span class="pl-k">list</span>(<span class="pl-v">kde2d.args</span><span class="pl-k">=</span><span class="pl-k">list</span>(<span class="pl-v">n</span><span class="pl-k">=</span><span class="pl-c1">100</span>, <span class="pl-v">h</span><span class="pl-k">=</span>c(<span class="pl-c1">10</span>,<span class="pl-c1">10</span>))))</pre></div>

<p><img src="README_files/figure-markdown_github/plot_diffnet2%20with%20map-1.png" alt=""></p>

<h3>
<a id="adopters-classification" class="anchor" href="#adopters-classification" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Adopters classification</h3>

<div class="highlight highlight-source-r"><pre><span class="pl-smi">out</span> <span class="pl-k">&lt;-</span> classify(<span class="pl-smi">kfamilyDiffNet</span>, <span class="pl-v">include_censored</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>, <span class="pl-v">addNA</span><span class="pl-k">=</span><span class="pl-c1">FALSE</span>)
ftable(<span class="pl-smi">out</span>)</pre></div>

<pre><code>##                thr Very Low Thresh. Low Thresh. High Thresh. Very High Thresh.    NA
## toa                                                                                 
## Early Adopters                14.04        8.40         0.57              0.29  0.00
## Early Majority                 5.64       11.65         5.54              2.58  0.00
## Late Majority                  1.34        5.06         6.21              2.96  0.00
## Laggards                       1.53        0.00         0.00             34.19  0.00
## NA                             0.00        0.00         0.00              0.00  0.00
</code></pre>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Computing color</span>
<span class="pl-smi">age</span> <span class="pl-k">&lt;-</span> <span class="pl-smi">kfamilyDiffNet</span>[[<span class="pl-s"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span>]]
<span class="pl-smi">age</span>[<span class="pl-smi">age</span><span class="pl-k">==</span><span class="pl-c1">0</span>] <span class="pl-k">&lt;-</span> mean(<span class="pl-smi">age</span>)

<span class="pl-c"># Mean by class</span>
<span class="pl-smi">cl</span>  <span class="pl-k">&lt;-</span> as.data.frame(<span class="pl-smi">out</span>)
<span class="pl-smi">Means</span> <span class="pl-k">&lt;-</span> with(<span class="pl-smi">out</span>, <span class="pl-k">matrix</span>(<span class="pl-c1">0</span>, <span class="pl-c1">4</span>, <span class="pl-c1">4</span>,
                        <span class="pl-v">dimnames</span> <span class="pl-k">=</span> <span class="pl-k">list</span>(levels(<span class="pl-smi">toa</span>), levels(<span class="pl-smi">thr</span>))))
<span class="pl-k">for</span> (<span class="pl-smi">l</span> <span class="pl-k">in</span> levels(<span class="pl-smi">out</span><span class="pl-k">$</span><span class="pl-smi">toa</span>))
  <span class="pl-k">for</span> (<span class="pl-smi">h</span> <span class="pl-k">in</span> levels(<span class="pl-smi">out</span><span class="pl-k">$</span><span class="pl-smi">thr</span>))
    <span class="pl-smi">Means</span>[<span class="pl-smi">l</span>,<span class="pl-smi">h</span>] <span class="pl-k">&lt;-</span> mean(<span class="pl-smi">age</span>[<span class="pl-smi">cl</span><span class="pl-k">$</span><span class="pl-smi">toa</span><span class="pl-k">==</span><span class="pl-smi">l</span> <span class="pl-k">&amp;</span> <span class="pl-smi">cl</span><span class="pl-k">$</span><span class="pl-smi">thr</span><span class="pl-k">==</span><span class="pl-smi">h</span>], <span class="pl-v">na.rm</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>)

<span class="pl-c"># Color palette</span>
<span class="pl-smi">Col</span> <span class="pl-k">&lt;-</span> <span class="pl-smi">Means</span>
<span class="pl-smi">Col</span>[] <span class="pl-k">&lt;-</span> (<span class="pl-smi">Means</span> <span class="pl-k">-</span> min(<span class="pl-smi">Means</span>, <span class="pl-v">na.rm</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>))<span class="pl-k">/</span>
  (max(<span class="pl-smi">Means</span>, <span class="pl-v">na.rm</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>) <span class="pl-k">-</span> min(<span class="pl-smi">Means</span>, <span class="pl-v">na.rm</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>))
<span class="pl-smi">Col</span>[is.nan(<span class="pl-smi">Col</span>)] <span class="pl-k">&lt;-</span> mean(<span class="pl-smi">Col</span>, <span class="pl-v">na.rm</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>)
<span class="pl-smi">Col</span>[] <span class="pl-k">&lt;-</span> rgb(colorRamp(<span class="pl-smi">blues9</span>)(<span class="pl-smi">Col</span>), <span class="pl-v">maxColorValue</span> <span class="pl-k">=</span> <span class="pl-c1">255</span>)

<span class="pl-c"># Plotting and adding key</span>
levels(<span class="pl-smi">out</span><span class="pl-k">$</span><span class="pl-smi">toa</span>) <span class="pl-k">&lt;-</span>
  sapply(strsplit(levels(<span class="pl-smi">out</span><span class="pl-k">$</span><span class="pl-smi">toa</span>), <span class="pl-s"><span class="pl-pds">"</span> <span class="pl-pds">"</span></span>), <span class="pl-smi">paste</span>, <span class="pl-v">collapse</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\n</span>             <span class="pl-pds">"</span></span>)
plot(<span class="pl-smi">out</span>, <span class="pl-v">color</span><span class="pl-k">=</span><span class="pl-smi">Col</span>, <span class="pl-v">las</span> <span class="pl-k">=</span> <span class="pl-c1">2</span>, <span class="pl-v">xlab</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Time of Adoption<span class="pl-pds">"</span></span>,
     <span class="pl-v">ylab</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Threshold<span class="pl-pds">"</span></span>, <span class="pl-v">main</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>, <span class="pl-v">ftable.args</span><span class="pl-k">=</span><span class="pl-k">list</span>(<span class="pl-v">addNA</span><span class="pl-k">=</span><span class="pl-c1">FALSE</span>))

drawColorKey(<span class="pl-smi">Means</span>, <span class="pl-v">nlevels</span> <span class="pl-k">=</span> <span class="pl-c1">50</span>, <span class="pl-v">border</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>transparent<span class="pl-pds">"</span></span>,
             <span class="pl-v">main</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Age<span class="pl-pds">"</span></span>,
             <span class="pl-v">color.palette</span> <span class="pl-k">=</span> colorRampPalette(<span class="pl-smi">blues9</span>)(<span class="pl-c1">50</span>),
             <span class="pl-v">key.pos</span> <span class="pl-k">=</span> c(.<span class="pl-c1">8</span>,.<span class="pl-c1">90</span>,.<span class="pl-c1">1</span>,.<span class="pl-c1">6</span>)
             )</pre></div>

<p><img src="README_files/figure-markdown_github/mosaic-1.png" alt=""></p>

<h3>
<a id="session-info" class="anchor" href="#session-info" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Session info</h3>

<div class="highlight highlight-source-r"><pre>sessionInfo()</pre></div>

<pre><code>## R version 3.3.0 (2016-05-03)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 14.04.4 LTS
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] SparseM_1.7        netdiffuseR_1.16.6
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.5     lattice_0.20-33 digest_0.6.9    MASS_7.3-45    
##  [5] grid_3.3.0      formatR_1.4     magrittr_1.5    evaluate_0.9   
##  [9] stringi_1.1.1   Matrix_1.2-6    sna_2.3-2       boot_1.3-18    
## [13] rmarkdown_0.9.6 tools_3.3.0     stringr_1.0.0   igraph_1.0.1   
## [17] yaml_2.1.13     htmltools_0.3.5 knitr_1.13
</code></pre>

<h2>
<a id="to-do-list" class="anchor" href="#to-do-list" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>To-do list</h2>

<ul>
<li>  Import/Export functions for interfacing other package's clases, in particular: <code>statnet</code> set (specially the packages <code>networkDynamic</code> and <code>ndtv</code>), <del><code>igraph</code></del> and <code>Rsiena</code>.</li>
<li>  Populate the tests folder.</li>
<li>  <del>Use spells? (<code>select_egoalter</code> would use this)</del>
</li>
<li>  Classify individuals by adoption category using early adopters, adopters, and laggards, and by threshold using very low, low, high and very high threshold (Valente 95' p. 94).</li>
<li>  <del>Double check all functions using adjacency matrix values.</del>
</li>
<li>  Remove dimnames from matrices and vectors. It is more efficient to use the ones stored in meta instead.</li>
<li>  Implement the Bass model</li>
<li>  <del>Include function to import survey data (as shown on the vignettes)</del>
</li>
<li>  Exposure based on Mahalanobis distances and also Roger Leenders on weighting exposure (internal note).</li>
</ul>

<h2>
<a id="--------2016-04-04-add-more-options-to-exposure-namely-self-so-removes-diagonal-or-not" class="anchor" href="#--------2016-04-04-add-more-options-to-exposure-namely-self-so-removes-diagonal-or-not" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>-   -   [2016-04-04]: Add more options to <code>exposure</code>, namely, <code>self</code> (so removes diagonal or not!).</h2>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/USCCANA/netdiffuseR/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/USCCANA/netdiffuseR/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/USCCANA/netdiffuseR"></a> is maintained by <a href="https://github.com/USCCANA">USCCANA</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
